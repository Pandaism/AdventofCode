Part 2 really need optimization... runtime took about 45min...